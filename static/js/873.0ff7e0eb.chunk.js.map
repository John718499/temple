{"version":3,"file":"static/js/873.0ff7e0eb.chunk.js","mappings":"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","sources":["pages/create/create.js","services/firebase-async.js","services/user-service.js"],"sourcesContent":["import React from 'react';\nimport { Link } from \"react-router-dom\";\nimport { AddActivity, ActivityCount, Today } from '../../services/user-service';\nimport { Button, Form, Col } from 'react-bootstrap';\nimport { NotificationManager } from 'react-notifications';\n\nclass Create extends React.Component{\n    \n    constructor(props){\n        super(props);\n        this.state={\n            name:\"\",\n            validated:false,\n            date:Today(),\n        }\n    }\n\n    NameInvalid(){\n        return this.state.validated && (this.state.name.length<2 || this.state.name.length>12);\n    }\n\n    DateInvalid(){\n        const today=new Date(Today());\n        const inputDate=new Date(this.state.date);\n        return this.state.validated && ( today >= inputDate);\n    }\n\n    render(){\n        return (\n            <Form noValidate onSubmit={this.Certain}>\n                <div className=\"container\">\n                    <div className=\"mx-auto shadow rounded mt-5 mb-5\" style={{ maxWidth: '600px', width: '100%', padding: '40px 30px'}}>\n                        <p className=\"fs-2 text-center\">建立點燈表單</p>\n                        <div className=\"row\">\n                            <Form.Group className=\"position-relative justify-content-center align-items-center d-flex mb-5\" as={Col} md=\"12\" controlId=\"name\">\n                                <Form.Label className=\"text-nowrap align-self-center mb-0 me-3\">名稱</Form.Label>\n                                <Form.Control\n                                    required\n                                    type=\"string\"\n                                    placeholder=\"請輸入名稱\"\n                                    value={this.state.name}\n                                    onChange={this.NameChange}\n                                    isInvalid={this.NameInvalid()}\n                                />\n                                <Form.Control.Feedback className=\"text-nowrap\" style={{top:\"calc(100% + 5px)\",left:\"12px\"}} type=\"invalid\" tooltip>{this.state.name===\"\"?\"必填\":\"字數必須介於2到12之間\"}</Form.Control.Feedback>\n                            </Form.Group>\n                            <Form.Group className=\"position-relative justify-content-center align-items-center d-flex mb-5\" as={Col} md=\"12\" controlId=\"date\">\n                                <Form.Label className=\"text-nowrap align-self-center mb-0 me-3\">截止日期</Form.Label>\n                                <Form.Control\n                                    required\n                                    type=\"date\"\n                                    value={this.state.date}\n                                    onChange={this.DateChange}\n                                    isInvalid={this.DateInvalid()}\n                                />\n                                <Form.Control.Feedback className=\"text-nowrap\" style={{top:\"calc(100% + 5px)\",left:\"12px\"}} type=\"invalid\" tooltip>{this.state.date===\"\"?\"必填\":\"請選擇今天之後的日期\"}</Form.Control.Feedback>\n                            </Form.Group>\n                        </div>\n                        <div className=\"col-12 p-3 text-center\">\n                            <Button className=\"me-3\" type=\"submit\">確認</Button>\n                            <Link className=\"btn btn-danger\" to={\"../join\"}>取消</Link>\n                        </div>\n                    </div>\n                </div>\n            </Form>\n        )\n    }\n\n    NameChange=(name)=>{\n        this.setState({name:name.target.value})\n    }\n\n    DateChange=(date)=>{\n        this.setState({date:date.target.value})\n    }\n\n    Certain = async (event) => {\n        event.preventDefault();\n        event.stopPropagation();\n\n        await this.setState({validated:true })\n        \n        const invalids=[\n            this.NameInvalid(),\n            this.DateInvalid(),\n        ]\n\n        if (invalids.some(invaild=>invaild)) return;\n\n        ActivityCount((result)=>{\n            let id=result;\n            AddActivity(\n                id,\n                {\n                    name:this.state.name,\n                    date:new Date(this.state.date).getTime(),\n                },\n                ()=>{\n                    NotificationManager.success('成功', '創建活動',3000);\n                },\n                ()=>{\n                    NotificationManager.error('錯誤', '創建活動',3000);\n                },\n            )\n        });\n    }\n}\n\nexport default Create;","import { getAuth } from \"firebase/auth\";\nimport { DatabaseReference,DataSnapshot,onValue } from 'firebase/database';\n\nconst auth = getAuth();\n\nexport const canActivate = () => {\n    return new Promise(resolve => {\n        if (auth.currentUser) {\n            resolve(true);\n        } else {\n            const unsubscribe = getAuth().onAuthStateChanged(function (user) {\n                unsubscribe();\n                if (user) {\n                    resolve(true);\n                } else {\n                    resolve(false);\n                }\n            });\n        }\n    });\n}\n\nexport const getAsync = (ref: DatabaseReference): Promise<DataSnapshot>=> {\n    return new Promise((resolve, reject) => {\n        function onError(error) {\n            reject(error);\n        } \n\n        function onData(snap) {\n            resolve(snap);\n        }\n  \n        onValue(ref, onData, onError, { onlyOnce: true });\n    });\n}","import {\n  getDatabase,\n  ref,\n  set,\n  get\n} from 'firebase/database';\nimport {\n  canActivate,\n  getAsync\n} from './firebase-async';\nimport {\n  getAuth\n} from \"firebase/auth\";\n\n\n\nconst db = getDatabase();\nconst auth = getAuth();\n\nexport const AllGeneralUser = async (callback) => {\n  let isActives = {};\n  let isAdmins = {};\n  let isSuperAdmins = {};\n\n  await getAsync(ref(db, \"isActive\")).then((snapshot) => {\n    if (snapshot.exists() && (typeof snapshot.val()) === \"object\") {\n      isActives = snapshot.val();\n    }\n  })\n\n  await getAsync(ref(db, \"isAdmin\")).then((snapshot) => {\n    if (snapshot.exists() && (typeof snapshot.val()) === \"object\") {\n      isAdmins = snapshot.val();\n    }\n  })\n\n  await getAsync(ref(db, \"isSuperAdmin\")).then((snapshot) => {\n    if (snapshot.exists() && (typeof snapshot.val()) === \"object\") {\n      isSuperAdmins = snapshot.val();\n    }\n  })\n\n  await getAsync(ref(db, `users`)).then((snapshot) => {\n    if (snapshot.exists()) {\n      const userData = snapshot.val();\n      const userIds = Object.keys(userData);\n      let userList = [];\n\n      for (let i = 0; i < userIds.length; i++) {\n\n        const oldData = userData[userIds[i]];\n        if (isSuperAdmins[userIds[i]] || isAdmins[userIds[i]]) continue;\n\n        let newData = {\n          Id: userIds[i],\n          email: oldData.email || false,\n          isActive: isActives[userIds[i]] || false,\n          isAdmin: isAdmins[userIds[i]] || false,\n          isChange: false,\n        }\n\n        userList.push(newData);\n      }\n\n      callback(userList);\n    } else {\n      callback([])\n    }\n  }).catch((error) => {\n    console.error(error);\n  });\n}\n\nexport const AllUser = async (callback) => {\n  let isActives = {};\n  let isAdmins = {};\n  let isSuperAdmins = {};\n\n  await getAsync(ref(db, \"isActive\")).then((snapshot) => {\n    if (snapshot.exists() && (typeof snapshot.val()) === \"object\") {\n      isActives = snapshot.val();\n    }\n  })\n\n  await getAsync(ref(db, \"isAdmin\")).then((snapshot) => {\n    if (snapshot.exists() && (typeof snapshot.val()) === \"object\") {\n      isAdmins = snapshot.val();\n    }\n  })\n\n  await getAsync(ref(db, \"isSuperAdmin\")).then((snapshot) => {\n    if (snapshot.exists() && (typeof snapshot.val()) === \"object\") {\n      isSuperAdmins = snapshot.val();\n    }\n  })\n\n  await getAsync(ref(db, \"users\")).then((snapshot) => {\n    if (snapshot.exists()) {\n      const userData = snapshot.val();\n      const userIds = Object.keys(userData);\n      let userList = [];\n\n      for (let i = 0; i < userIds.length; i++) {\n\n        const oldData = userData[userIds[i]];\n        if (isSuperAdmins[userIds[i]]) continue;\n\n        let newData = {\n          Id: userIds[i],\n          email: oldData.email || false,\n          isActive: isActives[userIds[i]] || false,\n          isAdmin: isAdmins[userIds[i]] || false,\n          isChange: false,\n        }\n\n        userList.push(newData);\n      }\n\n      callback(userList);\n    } else {\n      callback([])\n    }\n  }).catch((error) => {\n    console.error(error);\n  });\n}\n\nexport const UpdateAllGeneralUserAuth = (users, callback, errorCallback) => {\n  try {\n    for (let i = 0; i < users.length; i++) {\n      const oldData = users[i];\n      if (oldData.isChange) set(ref(db, `isActive/${oldData.Id}`), oldData.isActive)\n    }\n    callback();\n  } catch (error) {\n    errorCallback(error)\n  }\n}\n\nexport const UpdateAllUserAuth = (users, callback, errorCallback) => {\n  try {\n    for (let i = 0; i < users.length; i++) {\n      const oldData = users[i];\n      if (oldData.isChange) {\n        set(ref(db, `isActive/${oldData.Id}`), oldData.isActive)\n        set(ref(db, `isAdmin/${oldData.Id}`), oldData.isAdmin)\n      }\n    }\n    callback();\n  } catch (error) {\n    errorCallback(error)\n  }\n}\n\nexport const AddActivity = (id, data, callback, errorCallback) => {\n  set(ref(db, `activity/${id}`), {...data,time:new Date().getTime()}).then(_ => callback()).catch(_ => errorCallback());\n}\n\nexport const EditActivity = (id, data, callback, errorCallback) => {\n  set(ref(db, `activity/${id}`), {...data,time:new Date().getTime()}).then(_ => callback()).catch(errorCallback);\n}\n\nexport const ActivityCount = (callback) => {\n  get(ref(db, `activity/`)).then((snapshot) => {\n    if (snapshot.exists()) {\n      callback(Object.keys(snapshot.val()).length);\n    } else {\n      callback(0)\n    }\n  }).catch((error) => {\n    console.error(error);\n  });\n}\n\nexport const JoinActivity = async (callback) => {\n  await canActivate();\n  getAsync(ref(db, `activity`)).then((snapshot) => {\n    if (snapshot.exists()) {\n      const originData = snapshot.val().map((e, index) => ({ ...e, date: TimeToISOString(e.date), id: index }));\n      const filterSortData = originData.filter(e => new Date(Today()) <= new Date(e.date)).sort((a, b) => a.date < b.date ? 1 : -1);\n      callback(filterSortData);\n    } else {\n      callback([]);\n    }\n  }).catch((error) => {\n    console.error(error);\n  });\n}\n\nexport const AllActivity = async (callback) => {\n  await canActivate();\n  getAsync(ref(db, `activity`)).then((snapshot) => {\n    if (snapshot.exists()) {\n      const originData = snapshot.val().map((e, index) => ({ ...e,date: TimeToISOString(e.date), id: index, }));\n      callback(originData.sort((a, b) => a.date < b.date ? 1 : -1));\n    } else {\n      callback([]);\n    }\n  }).catch((error) => {\n    console.error(error);\n  });\n}\n\nexport const ActivityInfo = (id, callback) => {\n  getAsync(ref(db, `activity/${id}`)).then((snapshot) => {\n    if (snapshot.exists()) {\n      const data=snapshot.val();\n      callback({\n        name:data.name,\n        date:new Date(data.date).toISOString().split(\"T\")[0],\n      });\n    } else {\n      callback([]);\n    }\n  }).catch((error) => {\n    console.error(error);\n  });\n}\n\nexport const GetJoin = async (id, callback, errorCallback) => {\n  await canActivate();\n\n  const currentUser = auth.currentUser;\n  getAsync(ref(db, `join/${id}/${currentUser.uid}`)).then((snapshot) => {\n    if (snapshot.exists()) {\n      callback(snapshot.val());\n    } else {\n      callback(\n        [{\n          name: \"\",\n          birthday: \"\",\n          light1: false,\n          light2: false\n        },]\n      );\n    }\n  }).catch((error) => {\n    errorCallback(error)\n  });\n}\n\nexport const SentJoin = (id, data, callback, errorCallback) => {\n  const currentUser = auth.currentUser;\n  set(ref(db, `join/${id}/${currentUser.uid}`), data).then(_ => callback()).catch(_ => errorCallback());\n}\n\n\nexport const GetAllJoin = async (id, callback, errorCallback) => {\n  await canActivate();\n\n  getAsync(ref(db, `join/${id}`)).then((snapshot) => {\n    if (snapshot.exists()) {\n      const allOldData = snapshot.val();\n      const dataKey = Object.keys(allOldData);\n\n      let allNewData = [];\n      for (let i = 0; i < dataKey.length; i++) {\n        allNewData = allNewData.concat(allOldData[dataKey[i]]);\n      }\n\n      callback(allNewData);\n    } else {\n      callback(\n        []\n      );\n    }\n  }).catch((error) => {\n    errorCallback(error)\n  });\n}\n\n\nexport const SaveTemplate = async (data, callback, errorCallback) => {\n  await canActivate();\n  const currentUser = auth.currentUser;\n  set(ref(db, `template/${currentUser.uid}`), data).then(_ => callback()).catch(_ => errorCallback());\n}\n\nexport const LoadTemplate = async (callback, errorCallback) => {\n  await canActivate();\n  const currentUser = auth.currentUser;\n  getAsync(ref(db, `template/${currentUser.uid}`)).then((snapshot) => {\n    if (snapshot.exists()) {\n      callback(snapshot.val());\n    } else {\n      throw new Error('nodata');\n    }\n  }).catch((error) => {\n    errorCallback(error)\n  });\n}\n\nexport const Today = () => {\n  let today = new Date();\n  return `${today.getFullYear()}-${(today.getMonth() + 1).toString().padStart(2, '0')}-${today.getDate()}`;\n}\n\nexport const TimeToISOString = (time) => {\n  return new Date(time).toISOString().split(\"T\")[0]\n}"],"names":["Create","props","NameChange","name","setState","target","value","DateChange","date","Certain","event","preventDefault","stopPropagation","validated","NameInvalid","DateInvalid","some","invaild","ActivityCount","result","id","AddActivity","state","Date","getTime","NotificationManager","Today","this","length","today","inputDate","noValidate","onSubmit","className","style","maxWidth","width","padding","as","Col","md","controlId","required","type","placeholder","onChange","isInvalid","top","left","tooltip","to","React","auth","getAuth","canActivate","Promise","resolve","currentUser","unsubscribe","onAuthStateChanged","user","getAsync","ref","reject","onValue","snap","error","onlyOnce","db","getDatabase","AllGeneralUser","callback","isActives","isAdmins","isSuperAdmins","then","snapshot","exists","val","userData","userIds","Object","keys","userList","i","oldData","newData","Id","email","isActive","isAdmin","isChange","push","catch","console","AllUser","UpdateAllGeneralUserAuth","users","errorCallback","set","UpdateAllUserAuth","data","time","_","EditActivity","get","JoinActivity","filterSortData","map","e","index","TimeToISOString","filter","sort","a","b","AllActivity","originData","ActivityInfo","toISOString","split","GetJoin","uid","birthday","light1","light2","SentJoin","GetAllJoin","allOldData","dataKey","allNewData","concat","SaveTemplate","LoadTemplate","Error","getFullYear","getMonth","toString","padStart","getDate"],"sourceRoot":""}