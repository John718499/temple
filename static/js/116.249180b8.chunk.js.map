{"version":3,"file":"static/js/116.249180b8.chunk.js","mappings":"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","sources":["pages/edit/edit.js","services/firebase-async.js","services/user-service.js"],"sourcesContent":["import React from 'react';\nimport { Link, useParams } from \"react-router-dom\";\nimport { ActivityInfo, EditActivity, Today } from '../../services/user-service';\nimport { Button, Form, Col } from 'react-bootstrap';\nimport { NotificationManager } from 'react-notifications';\nimport { Loading } from '../../components/loading'; \n\nclass Edit extends React.Component{\n    \n    constructor(props){\n        super(props);\n        this.state={\n            name:\"\",\n            validated:false,\n            date:\"\",\n            expire:false,\n        }\n    }\n\n    componentDidMount(){\n        ActivityInfo(this.props.id,(result)=>{\n            this.setState({\n                name:result.name,\n                date:result.date,\n                expire:this.Expire(result.date),\n            })\n        })\n    }\n\n    DateInvalid(){\n        const today=new Date(Today());\n        const inputDate=new Date(this.state.date);\n        return this.state.validated && ( today >= inputDate);\n    }\n\n    Expire=(time)=>{\n        const date=new Date(time).getTime();\n        const today=new Date().getTime();\n        return today - date >=60*60*24*90*1000;\n    }\n\n    render(){\n        if(this.state.name ===\"\" && this.state.date===\"\")return (<Loading />);\n        return (\n            <Form noValidate onSubmit={this.Certain}>\n                <div className=\"container\">\n                    <div className=\"mx-auto shadow rounded mt-5 mb-5\" style={{ maxWidth: '600px', width: '100%', padding: '40px 30px'}}>\n                        <p className=\"fs-2 text-center\">修改截止日期</p>\n                        <div className=\"row\">\n                            <label>名稱:{this.state.name}</label>\n                            <Form.Group className=\"position-relative justify-content-center align-items-center d-flex mb-5\" as={Col} md=\"12\" controlId=\"date\">\n                                <Form.Label className=\"text-nowrap align-self-center mb-0 me-3\">截止日期</Form.Label>\n                                <Form.Control\n                                    required\n                                    type=\"date\"\n                                    value={this.state.date}\n                                    onChange={this.DateChange}\n                                    isInvalid={this.DateInvalid()}\n                                    disabled={this.state.expire}\n                                />\n                                <Form.Control.Feedback className=\"text-nowrap\" style={{top:\"calc(100% + 5px)\",left:\"12px\"}} type=\"invalid\" tooltip>{this.state.date===\"\"?\"必填\":\"請選擇今天之後的日期\"}</Form.Control.Feedback>\n                            </Form.Group>\n                        </div>\n                        <div className={`position-relative ${this.state.expire?\"\":\"d-none\"}`}>\n                            <div className=\"text-nowrap invalid-tooltip d-block\" style={{top: \"calc(100% - 34px)\", left: \"12px\"}}>過期90天，無法更改截止日期</div>\n                        </div>\n                        <div className=\"col-12 p-3 text-center\">\n                            <Button disabled={this.state.expire} className=\"me-3\" type=\"submit\">確認</Button>\n                            <Link className=\"btn btn-danger\" to={\"../join\"}>取消</Link>\n                        </div>\n                    </div>\n                </div>\n            </Form>\n        )\n    }\n\n    NameChange=(name)=>{\n        this.setState({name:name.target.value})\n    }\n\n    DateChange=(date)=>{\n        this.setState({date:date.target.value})\n    }\n\n    Certain = async (event) => {\n        event.preventDefault();\n        event.stopPropagation();\n\n        await this.setState({validated:true })\n        \n        const invalids=[\n            this.DateInvalid(),\n        ]\n\n        if (invalids.some(invaild=>invaild)) return;\n\n        EditActivity(\n            this.props.id,\n            {\n                name:this.state.name,\n                date:new Date(this.state.date).getTime(),\n            },\n            ()=>{\n                NotificationManager.success('成功', '修改活動',3000);\n            },\n            ()=>{\n                NotificationManager.error('錯誤', '修改活動',3000);\n            },\n        )\n    }\n}\n\n\nexport default function EditParam () {\n    const { id } = useParams();\n\n    return(\n        <Edit id={id} />\n    )\n\n}","import { getAuth } from \"firebase/auth\";\nimport { DatabaseReference,DataSnapshot,onValue } from 'firebase/database';\n\nconst auth = getAuth();\n\nexport const canActivate = () => {\n    return new Promise(resolve => {\n        if (auth.currentUser) {\n            resolve(true);\n        } else {\n            const unsubscribe = getAuth().onAuthStateChanged(function (user) {\n                unsubscribe();\n                if (user) {\n                    resolve(true);\n                } else {\n                    resolve(false);\n                }\n            });\n        }\n    });\n}\n\nexport const getAsync = (ref: DatabaseReference): Promise<DataSnapshot>=> {\n    return new Promise((resolve, reject) => {\n        function onError(error) {\n            reject(error);\n        } \n\n        function onData(snap) {\n            resolve(snap);\n        }\n  \n        onValue(ref, onData, onError, { onlyOnce: true });\n    });\n}","import {\n  getDatabase,\n  ref,\n  set,\n  get\n} from 'firebase/database';\nimport {\n  canActivate,\n  getAsync\n} from './firebase-async';\nimport {\n  getAuth\n} from \"firebase/auth\";\n\n\n\nconst db = getDatabase();\nconst auth = getAuth();\n\nexport const AllGeneralUser = async (callback) => {\n  let isActives = {};\n  let isAdmins = {};\n  let isSuperAdmins = {};\n\n  await getAsync(ref(db, \"isActive\")).then((snapshot) => {\n    if (snapshot.exists() && (typeof snapshot.val()) === \"object\") {\n      isActives = snapshot.val();\n    }\n  })\n\n  await getAsync(ref(db, \"isAdmin\")).then((snapshot) => {\n    if (snapshot.exists() && (typeof snapshot.val()) === \"object\") {\n      isAdmins = snapshot.val();\n    }\n  })\n\n  await getAsync(ref(db, \"isSuperAdmin\")).then((snapshot) => {\n    if (snapshot.exists() && (typeof snapshot.val()) === \"object\") {\n      isSuperAdmins = snapshot.val();\n    }\n  })\n\n  await getAsync(ref(db, `users`)).then((snapshot) => {\n    if (snapshot.exists()) {\n      const userData = snapshot.val();\n      const userIds = Object.keys(userData);\n      let userList = [];\n\n      for (let i = 0; i < userIds.length; i++) {\n\n        const oldData = userData[userIds[i]];\n        if (isSuperAdmins[userIds[i]] || isAdmins[userIds[i]]) continue;\n\n        let newData = {\n          Id: userIds[i],\n          email: oldData.email || false,\n          isActive: isActives[userIds[i]] || false,\n          isAdmin: isAdmins[userIds[i]] || false,\n          isChange: false,\n        }\n\n        userList.push(newData);\n      }\n\n      callback(userList);\n    } else {\n      callback([])\n    }\n  }).catch((error) => {\n    console.error(error);\n  });\n}\n\nexport const AllUser = async (callback) => {\n  let isActives = {};\n  let isAdmins = {};\n  let isSuperAdmins = {};\n\n  await getAsync(ref(db, \"isActive\")).then((snapshot) => {\n    if (snapshot.exists() && (typeof snapshot.val()) === \"object\") {\n      isActives = snapshot.val();\n    }\n  })\n\n  await getAsync(ref(db, \"isAdmin\")).then((snapshot) => {\n    if (snapshot.exists() && (typeof snapshot.val()) === \"object\") {\n      isAdmins = snapshot.val();\n    }\n  })\n\n  await getAsync(ref(db, \"isSuperAdmin\")).then((snapshot) => {\n    if (snapshot.exists() && (typeof snapshot.val()) === \"object\") {\n      isSuperAdmins = snapshot.val();\n    }\n  })\n\n  await getAsync(ref(db, \"users\")).then((snapshot) => {\n    if (snapshot.exists()) {\n      const userData = snapshot.val();\n      const userIds = Object.keys(userData);\n      let userList = [];\n\n      for (let i = 0; i < userIds.length; i++) {\n\n        const oldData = userData[userIds[i]];\n        if (isSuperAdmins[userIds[i]]) continue;\n\n        let newData = {\n          Id: userIds[i],\n          email: oldData.email || false,\n          isActive: isActives[userIds[i]] || false,\n          isAdmin: isAdmins[userIds[i]] || false,\n          isChange: false,\n        }\n\n        userList.push(newData);\n      }\n\n      callback(userList);\n    } else {\n      callback([])\n    }\n  }).catch((error) => {\n    console.error(error);\n  });\n}\n\nexport const UpdateAllGeneralUserAuth = (users, callback, errorCallback) => {\n  try {\n    for (let i = 0; i < users.length; i++) {\n      const oldData = users[i];\n      if (oldData.isChange) set(ref(db, `isActive/${oldData.Id}`), oldData.isActive)\n    }\n    callback();\n  } catch (error) {\n    errorCallback(error)\n  }\n}\n\nexport const UpdateAllUserAuth = (users, callback, errorCallback) => {\n  try {\n    for (let i = 0; i < users.length; i++) {\n      const oldData = users[i];\n      if (oldData.isChange) {\n        set(ref(db, `isActive/${oldData.Id}`), oldData.isActive)\n        set(ref(db, `isAdmin/${oldData.Id}`), oldData.isAdmin)\n      }\n    }\n    callback();\n  } catch (error) {\n    errorCallback(error)\n  }\n}\n\nexport const AddActivity = (id, data, callback, errorCallback) => {\n  set(ref(db, `activity/${id}`), {...data,time:new Date().getTime()}).then(_ => callback()).catch(_ => errorCallback());\n}\n\nexport const EditActivity = (id, data, callback, errorCallback) => {\n  set(ref(db, `activity/${id}`), {...data,time:new Date().getTime()}).then(_ => callback()).catch(errorCallback);\n}\n\nexport const ActivityCount = (callback) => {\n  get(ref(db, `activity/`)).then((snapshot) => {\n    if (snapshot.exists()) {\n      callback(Object.keys(snapshot.val()).length);\n    } else {\n      callback(0)\n    }\n  }).catch((error) => {\n    console.error(error);\n  });\n}\n\nexport const JoinActivity = async (callback) => {\n  await canActivate();\n  getAsync(ref(db, `activity`)).then((snapshot) => {\n    if (snapshot.exists()) {\n      const originData = snapshot.val().map((e, index) => ({ ...e, date: TimeToISOString(e.date), id: index }));\n      const filterSortData = originData.filter(e => new Date(Today()) <= new Date(e.date)).sort((a, b) => a.date < b.date ? 1 : -1);\n      callback(filterSortData);\n    } else {\n      callback([]);\n    }\n  }).catch((error) => {\n    console.error(error);\n  });\n}\n\nexport const AllActivity = async (callback) => {\n  await canActivate();\n  getAsync(ref(db, `activity`)).then((snapshot) => {\n    if (snapshot.exists()) {\n      const originData = snapshot.val().map((e, index) => ({ ...e,date: TimeToISOString(e.date), id: index, }));\n      callback(originData.sort((a, b) => a.date < b.date ? 1 : -1));\n    } else {\n      callback([]);\n    }\n  }).catch((error) => {\n    console.error(error);\n  });\n}\n\nexport const ActivityInfo = (id, callback) => {\n  getAsync(ref(db, `activity/${id}`)).then((snapshot) => {\n    if (snapshot.exists()) {\n      const data=snapshot.val();\n      callback({\n        name:data.name,\n        date:new Date(data.date).toISOString().split(\"T\")[0],\n      });\n    } else {\n      callback([]);\n    }\n  }).catch((error) => {\n    console.error(error);\n  });\n}\n\nexport const GetJoin = async (id, callback, errorCallback) => {\n  await canActivate();\n\n  const currentUser = auth.currentUser;\n  getAsync(ref(db, `join/${id}/${currentUser.uid}`)).then((snapshot) => {\n    if (snapshot.exists()) {\n      callback(snapshot.val());\n    } else {\n      callback(\n        [{\n          name: \"\",\n          birthday: \"\",\n          light1: false,\n          light2: false\n        },]\n      );\n    }\n  }).catch((error) => {\n    errorCallback(error)\n  });\n}\n\nexport const SentJoin = (id, data, callback, errorCallback) => {\n  const currentUser = auth.currentUser;\n  set(ref(db, `join/${id}/${currentUser.uid}`), data).then(_ => callback()).catch(_ => errorCallback());\n}\n\n\nexport const GetAllJoin = async (id, callback, errorCallback) => {\n  await canActivate();\n\n  getAsync(ref(db, `join/${id}`)).then((snapshot) => {\n    if (snapshot.exists()) {\n      const allOldData = snapshot.val();\n      const dataKey = Object.keys(allOldData);\n\n      let allNewData = [];\n      for (let i = 0; i < dataKey.length; i++) {\n        allNewData = allNewData.concat(allOldData[dataKey[i]]);\n      }\n\n      callback(allNewData);\n    } else {\n      callback(\n        []\n      );\n    }\n  }).catch((error) => {\n    errorCallback(error)\n  });\n}\n\n\nexport const SaveTemplate = async (data, callback, errorCallback) => {\n  await canActivate();\n  const currentUser = auth.currentUser;\n  set(ref(db, `template/${currentUser.uid}`), data).then(_ => callback()).catch(_ => errorCallback());\n}\n\nexport const LoadTemplate = async (callback, errorCallback) => {\n  await canActivate();\n  const currentUser = auth.currentUser;\n  getAsync(ref(db, `template/${currentUser.uid}`)).then((snapshot) => {\n    if (snapshot.exists()) {\n      callback(snapshot.val());\n    } else {\n      throw new Error('nodata');\n    }\n  }).catch((error) => {\n    errorCallback(error)\n  });\n}\n\nexport const Today = () => {\n  let today = new Date();\n  return `${today.getFullYear()}-${(today.getMonth() + 1).toString().padStart(2, '0')}-${today.getDate()}`;\n}\n\nexport const TimeToISOString = (time) => {\n  return new Date(time).toISOString().split(\"T\")[0]\n}"],"names":["Edit","props","Expire","time","date","Date","getTime","NameChange","name","setState","target","value","DateChange","Certain","event","preventDefault","stopPropagation","validated","DateInvalid","some","invaild","EditActivity","id","state","NotificationManager","expire","ActivityInfo","this","result","today","Today","inputDate","noValidate","onSubmit","className","style","maxWidth","width","padding","as","Col","md","controlId","required","type","onChange","isInvalid","disabled","top","left","tooltip","to","React","EditParam","useParams","auth","getAuth","canActivate","Promise","resolve","currentUser","unsubscribe","onAuthStateChanged","user","getAsync","ref","reject","onValue","snap","error","onlyOnce","db","getDatabase","AllGeneralUser","callback","isActives","isAdmins","isSuperAdmins","then","snapshot","exists","val","userData","userIds","Object","keys","userList","i","length","oldData","newData","Id","email","isActive","isAdmin","isChange","push","catch","console","AllUser","UpdateAllGeneralUserAuth","users","errorCallback","set","UpdateAllUserAuth","AddActivity","data","_","ActivityCount","get","JoinActivity","filterSortData","map","e","index","TimeToISOString","filter","sort","a","b","AllActivity","originData","toISOString","split","GetJoin","uid","birthday","light1","light2","SentJoin","GetAllJoin","allOldData","dataKey","allNewData","concat","SaveTemplate","LoadTemplate","Error","getFullYear","getMonth","toString","padStart","getDate"],"sourceRoot":""}