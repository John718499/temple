{"version":3,"file":"static/js/718.4d009ab3.chunk.js","mappings":"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","sources":["pages/login/login.js","services/account-service.js","services/firebase-async.js"],"sourcesContent":["import React from 'react';\r\nimport { Link, useNavigate } from \"react-router-dom\";\r\nimport { LoginAccount } from '../../services/account-service';\r\nimport { NotificationManager} from 'react-notifications';\r\n\r\nclass Login extends React.Component{\r\n\r\n    constructor(props){\r\n        super(props)\r\n        this.state = {\r\n            email:\"\",\r\n            password:\"\",\r\n        }\r\n    }\r\n\r\n    EmailChange=(email)=>{\r\n        this.setState({email:email.target.value});\r\n    }\r\n\r\n    PasswordChange=(password)=>{\r\n        this.setState({password:password.target.value});\r\n    }\r\n\r\n    LoginClick=()=>{\r\n        LoginAccount(\r\n            this.state.email,\r\n            this.state.password,\r\n            async ()=>{\r\n                NotificationManager.success('成功', '登入',3000);\r\n                this.props.navigate('/join')\r\n            },\r\n            (error)=>{\r\n                console.log(error);\r\n                NotificationManager.error('帳號或密碼錯誤', '登入',3000);\r\n            }\r\n        )\r\n    }\r\n\r\n    render(){\r\n        return (\r\n            <div className=\"mx-auto\" style={{maxWidth: '330px',width: '100%',padding:'50px 15px 15px 15px'}}>\r\n                <div>\r\n                    <p className=\"fs-2 text-center\">登入</p>\r\n                    <input className=\"form-control mb-2\" type=\"email\" value={this.state.email} onChange={this.EmailChange} placeholder=\"輸入您的電子郵件\" />\r\n                    <input className=\"form-control\" type=\"password\" value={this.state.password} onChange={this.PasswordChange} placeholder=\"輸入您的密碼\" />\r\n                    <div className=\"mt-3 d-flex justify-content-around\">\r\n                    <button className=\"btn btn-primary me-1 col-6\" onClick={this.LoginClick}>登入</button>\r\n                    <Link className=\"btn btn-primary col-6\" to=\"/register\">註冊</Link>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        )\r\n    } \r\n}\r\n\r\nexport default function LoginNavigate(props) {\r\n    const navigate = useNavigate();\r\n  \r\n    return <Login {...props} navigate={navigate} />;\r\n  }","import { getDatabase, ref, set } from 'firebase/database';\r\nimport { canActivate, getAsync } from './firebase-async';\r\nimport { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword } from \"firebase/auth\";\r\n\r\nconst auth = getAuth();\r\nconst db = getDatabase();\r\n\r\nexport const CurrentUser = async () => {\r\n    await canActivate();\r\n    return auth.currentUser;\r\n}\r\n\r\nexport const RegisterAccount = (email, password, callback, errorCallback) => {\r\n    createUserWithEmailAndPassword(auth, email, password)\r\n        .then(AddUser)\r\n        .then(callback)\r\n        .catch(errorCallback);\r\n}\r\n\r\nexport const LoginAccount = (email, password, callback, errorCallback) => {\r\n    signInWithEmailAndPassword(auth, email, password)\r\n        .then(AddUser)\r\n        .then(callback)\r\n        .catch(errorCallback);\r\n}\r\n\r\nexport const Logout = async (callback, errorCallback) => {\r\n    await canActivate();\r\n    auth.signOut().then(callback).catch(errorCallback);\r\n}\r\n\r\nexport const AddUser = () => {\r\n    const currentUser = auth.currentUser;\r\n    set(ref(db, `users/${currentUser.uid}/email`), currentUser.email);\r\n}\r\n\r\nexport const Auth = async () => {\r\n    const currentUser = auth.currentUser;\r\n    await getAsync(ref(db, `users/${currentUser.uid}`))\r\n        .then((snapshot) => {\r\n            if (snapshot.exists()) {\r\n                let userInfo = snapshot.val();\r\n                localStorage.setItem(\"email\", userInfo.email || false);\r\n            } else\r\n                throw new Error('nodata')\r\n        })\r\n        .catch(() => localStorage.removeItem(\"email\"))\r\n\r\n    await getAsync(ref(db, `isSuperAdmin/${currentUser.uid}`))\r\n        .then((snapshot) => {\r\n            if (snapshot.exists())\r\n                localStorage.setItem(\"isSuperAdmin\", snapshot.val() || false);\r\n            else\r\n                throw new Error('nodata')\r\n        })\r\n        .catch(() => localStorage.removeItem(\"isSuperAdmin\"))\r\n\r\n    await getAsync(ref(db, `isAdmin/${currentUser.uid}`))\r\n        .then((snapshot) => {\r\n            if (snapshot.exists())\r\n                localStorage.setItem(\"isAdmin\", snapshot.val() || false);\r\n            else\r\n                throw new Error('nodata')\r\n        })\r\n        .catch(() => localStorage.removeItem(\"isAdmin\"))\r\n\r\n    await getAsync(ref(db, `isActive/${currentUser.uid}`))\r\n        .then((snapshot) => {\r\n            if (snapshot.exists())\r\n                localStorage.setItem(\"isActive\", snapshot.val() || false);\r\n            else\r\n                throw new Error('nodata')\r\n        })\r\n        .catch(() => localStorage.removeItem(\"isActive\"))\r\n}","import { getAuth } from \"firebase/auth\";\r\nimport { DatabaseReference,DataSnapshot,onValue } from 'firebase/database';\r\n\r\nconst auth = getAuth();\r\n\r\nexport const canActivate = () => {\r\n    return new Promise(resolve => {\r\n        if (auth.currentUser) {\r\n            resolve(true);\r\n        } else {\r\n            const unsubscribe = getAuth().onAuthStateChanged(function (user) {\r\n                unsubscribe();\r\n                if (user) {\r\n                    resolve(true);\r\n                } else {\r\n                    resolve(false);\r\n                }\r\n            });\r\n        }\r\n    });\r\n}\r\n\r\nexport const getAsync = (ref: DatabaseReference): Promise<DataSnapshot>=> {\r\n    return new Promise((resolve, reject) => {\r\n        function onError(error) {\r\n            reject(error);\r\n        } \r\n\r\n        function onData(snap) {\r\n            resolve(snap);\r\n        }\r\n  \r\n        onValue(ref, onData, onError, { onlyOnce: true });\r\n    });\r\n}"],"names":["Login","props","EmailChange","email","setState","target","value","PasswordChange","password","LoginClick","LoginAccount","state","NotificationManager","navigate","error","console","log","className","style","maxWidth","width","padding","type","this","onChange","placeholder","onClick","to","React","LoginNavigate","useNavigate","auth","getAuth","db","getDatabase","CurrentUser","canActivate","currentUser","RegisterAccount","callback","errorCallback","createUserWithEmailAndPassword","then","AddUser","catch","signInWithEmailAndPassword","Logout","signOut","set","ref","uid","Auth","getAsync","snapshot","exists","Error","userInfo","val","localStorage","setItem","removeItem","Promise","resolve","unsubscribe","onAuthStateChanged","user","reject","onValue","snap","onlyOnce"],"sourceRoot":""}