"use strict";(self.webpackChunktemple=self.webpackChunktemple||[]).push([[503],{4503:function(t,n,e){e.r(n);var r=e(4165),i=e(5861),c=e(5671),a=e(3144),o=e(136),u=e(9388),s=e(2791),f=e(3504),l=e(2822),v=e(3446),h=e(184),d=function(t){(0,o.Z)(e,t);var n=(0,u.Z)(e);function e(t){var a;return(0,c.Z)(this,e),(a=n.call(this,t)).RecoverPosition=(0,i.Z)((0,r.Z)().mark((function t(){var n;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(n=localStorage.getItem("joinListX"))&&(document.getElementsByTagName("html")[0].scrollTop=n,localStorage.removeItem("joinListX"));case 2:case"end":return t.stop()}}),t)}))),a.RecordPosition=function(){localStorage.setItem("joinListX",document.getElementsByTagName("html")[0].scrollTop)},a.state={activitys:null,isAdmin:"true"===localStorage.getItem("isAdmin"),isSuperAdmin:"true"===localStorage.getItem("isSuperAdmin"),scrollPosition:0},a}return(0,a.Z)(e,[{key:"componentDidMount",value:function(){var t=this;this.state.isAdmin||this.state.isSuperAdmin?(0,l.u$)((function(n){t.setState({activitys:n},(function(){t.RecoverPosition()}))})):(0,l.CK)(function(){var n=(0,i.Z)((0,r.Z)().mark((function n(e){return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t.setState({activitys:e},(function(){t.RecoverPosition()}));case 1:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}())}},{key:"render",value:function(){return this.state.activitys?(0,h.jsx)("div",{className:"container mt-4",children:this.ListContent()}):(0,h.jsx)(v.g,{})}},{key:"ListContent",value:function(){var t=this;return this.state.activitys.map((function(n){var e=null,r=null;return(t.state.isAdmin||t.state.isSuperAdmin)&&(e=(0,h.jsx)(f.rU,{onClick:t.RecordPosition,to:"./../manage/join/".concat(n.id),children:"\u8868\u55ae\u8cc7\u6599"}),r=(0,h.jsx)(f.rU,{to:"./../edit/".concat(n.id),children:(0,h.jsx)("i",{className:"bi bi-pen"})})),(0,h.jsx)("div",{className:"row p-3",children:(0,h.jsx)("div",{className:"mx-auto shadow rounded mt-3 mb-3",style:{maxWidth:"600px",width:"100%",padding:"40px 30px"},children:(0,h.jsxs)("div",{className:"row",children:[(0,h.jsxs)("div",{className:"col-12 mb-3 d-flex align-items-center",children:[(0,h.jsx)("h5",{className:"mb-0 me-2",children:n.name}),r]}),(0,h.jsxs)("div",{className:"col-12 mb-3",children:["\u622a\u6b62\u65e5\u671f:",n.date]}),(0,h.jsxs)("div",{className:"col-12",children:[(0,h.jsx)(f.rU,{className:"me-3",onClick:t.RecordPosition,to:"./".concat(n.id),children:"\u8f38\u5165\u8cc7\u6599"}),e]})]})})},n.id)}))}}]),e}(s.Component);n.default=d},6115:function(t,n,e){e.d(n,{C:function(){return o},n:function(){return a}});var r=e(9033),i=e(408),c=(0,r.v0)(),a=function(){return new Promise((function(t){if(c.currentUser)t(!0);else var n=(0,r.v0)().onAuthStateChanged((function(e){n(),t(!!e)}))}))},o=function(t){return new Promise((function(n,e){(0,i.jM)(t,(function(t){n(t)}),(function(t){e(t)}),{onlyOnce:!0})}))}},2822:function(t,n,e){e.d(n,{CK:function(){return Z},Ce:function(){return m},EJ:function(){return x},N5:function(){return k},NI:function(){return p},Ne:function(){return C},Os:function(){return g},Wo:function(){return l},Z9:function(){return h},_k:function(){return w},_x:function(){return A},av:function(){return d},gk:function(){return j},tf:function(){return H},u$:function(){return y},xJ:function(){return v}});var r=e(1413),i=e(4165),c=e(5861),a=e(408),o=e(6115),u=e(9033),s=(0,a.N8)(),f=(0,u.v0)(),l=function(){var t=(0,c.Z)((0,i.Z)().mark((function t(n){var e,r,c;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e={},r={},c={},t.next=5,(0,o.C)((0,a.iH)(s,"isActive")).then((function(t){t.exists()&&"object"===typeof t.val()&&(e=t.val())}));case 5:return t.next=7,(0,o.C)((0,a.iH)(s,"isAdmin")).then((function(t){t.exists()&&"object"===typeof t.val()&&(r=t.val())}));case 7:return t.next=9,(0,o.C)((0,a.iH)(s,"isSuperAdmin")).then((function(t){t.exists()&&"object"===typeof t.val()&&(c=t.val())}));case 9:return t.next=11,(0,o.C)((0,a.iH)(s,"users")).then((function(t){if(t.exists()){for(var i=t.val(),a=Object.keys(i),o=[],u=0;u<a.length;u++){var s=i[a[u]];if(!c[a[u]]&&!r[a[u]]){var f={Id:a[u],email:s.email||!1,isActive:e[a[u]]||!1,isAdmin:r[a[u]]||!1,isChange:!1};o.push(f)}}n(o)}else n([])})).catch((function(t){console.error(t)}));case 11:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),v=function(){var t=(0,c.Z)((0,i.Z)().mark((function t(n){var e,r,c;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e={},r={},c={},t.next=5,(0,o.C)((0,a.iH)(s,"isActive")).then((function(t){t.exists()&&"object"===typeof t.val()&&(e=t.val())}));case 5:return t.next=7,(0,o.C)((0,a.iH)(s,"isAdmin")).then((function(t){t.exists()&&"object"===typeof t.val()&&(r=t.val())}));case 7:return t.next=9,(0,o.C)((0,a.iH)(s,"isSuperAdmin")).then((function(t){t.exists()&&"object"===typeof t.val()&&(c=t.val())}));case 9:return t.next=11,(0,o.C)((0,a.iH)(s,"users")).then((function(t){if(t.exists()){for(var i=t.val(),a=Object.keys(i),o=[],u=0;u<a.length;u++){var s=i[a[u]];if(!c[a[u]]){var f={Id:a[u],email:s.email||!1,isActive:e[a[u]]||!1,isAdmin:r[a[u]]||!1,isChange:!1};o.push(f)}}n(o)}else n([])})).catch((function(t){console.error(t)}));case 11:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),h=function(t,n,e){try{for(var r=0;r<t.length;r++){var i=t[r];i.isChange&&(0,a.t8)((0,a.iH)(s,"isActive/".concat(i.Id)),i.isActive)}n()}catch(c){e(c)}},d=function(t,n,e){try{for(var r=0;r<t.length;r++){var i=t[r];i.isChange&&((0,a.t8)((0,a.iH)(s,"isActive/".concat(i.Id)),i.isActive),(0,a.t8)((0,a.iH)(s,"isAdmin/".concat(i.Id)),i.isAdmin))}n()}catch(c){e(c)}},m=function(t,n,e,i){(0,a.t8)((0,a.iH)(s,"activity/".concat(t)),(0,r.Z)((0,r.Z)({},n),{},{time:(new Date).getTime()})).then((function(t){return e()})).catch((function(t){return i()}))},p=function(t,n,e,i){(0,a.t8)((0,a.iH)(s,"activity/".concat(t)),(0,r.Z)((0,r.Z)({},n),{},{time:(new Date).getTime()})).then((function(t){return e()})).catch(i)},x=function(t){(0,a.U2)((0,a.iH)(s,"activity/")).then((function(n){n.exists()?t(Object.keys(n.val()).length):t(0)})).catch((function(t){console.error(t)}))},Z=function(){var t=(0,c.Z)((0,i.Z)().mark((function t(n){return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,o.n)();case 2:(0,o.C)((0,a.iH)(s,"activity")).then((function(t){if(t.exists()){var e=t.val().map((function(t,n){return(0,r.Z)((0,r.Z)({},t),{},{date:S(t.date),id:n})})).filter((function(t){return new Date(H())<=new Date(t.date)})).sort((function(t,n){return t.date<n.date?1:-1}));n(e)}else n([])})).catch((function(t){console.error(t)}));case 3:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),y=function(){var t=(0,c.Z)((0,i.Z)().mark((function t(n){return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,o.n)();case 2:(0,o.C)((0,a.iH)(s,"activity")).then((function(t){if(t.exists()){var e=t.val().map((function(t,n){return(0,r.Z)((0,r.Z)({},t),{},{date:S(t.date),id:n})}));n(e.sort((function(t,n){return t.date<n.date?1:-1})))}else n([])})).catch((function(t){console.error(t)}));case 3:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),g=function(t,n){(0,o.C)((0,a.iH)(s,"activity/".concat(t))).then((function(t){if(t.exists()){var e=t.val();n({name:e.name,date:new Date(e.date).toISOString().split("T")[0]})}else n([])})).catch((function(t){console.error(t)}))},w=function(){var t=(0,c.Z)((0,i.Z)().mark((function t(n,e,r){var c;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,o.n)();case 2:c=f.currentUser,(0,o.C)((0,a.iH)(s,"join/".concat(n,"/").concat(c.uid))).then((function(t){t.exists()?e(t.val()):e([{name:"",birthday:"",light1:!1,light2:!1}])})).catch((function(t){r(t)}));case 4:case"end":return t.stop()}}),t)})));return function(n,e,r){return t.apply(this,arguments)}}(),j=function(t,n,e,r){var i=f.currentUser;(0,a.t8)((0,a.iH)(s,"join/".concat(t,"/").concat(i.uid)),n).then((function(t){return e()})).catch((function(t){return r()}))},C=function(){var t=(0,c.Z)((0,i.Z)().mark((function t(n,e,r){return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,o.n)();case 2:(0,o.C)((0,a.iH)(s,"join/".concat(n))).then((function(t){if(t.exists()){for(var n=t.val(),r=Object.keys(n),i=[],c=0;c<r.length;c++)i=i.concat(n[r[c]]);e(i)}else e([])})).catch((function(t){r(t)}));case 3:case"end":return t.stop()}}),t)})));return function(n,e,r){return t.apply(this,arguments)}}(),k=function(){var t=(0,c.Z)((0,i.Z)().mark((function t(n,e,r){var c;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,o.n)();case 2:c=f.currentUser,(0,a.t8)((0,a.iH)(s,"template/".concat(c.uid)),n).then((function(t){return e()})).catch((function(t){return r()}));case 4:case"end":return t.stop()}}),t)})));return function(n,e,r){return t.apply(this,arguments)}}(),A=function(){var t=(0,c.Z)((0,i.Z)().mark((function t(n,e){var r;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,o.n)();case 2:r=f.currentUser,(0,o.C)((0,a.iH)(s,"template/".concat(r.uid))).then((function(t){if(!t.exists())throw new Error("nodata");n(t.val())})).catch((function(t){e(t)}));case 4:case"end":return t.stop()}}),t)})));return function(n,e){return t.apply(this,arguments)}}(),H=function(){var t=new Date;return"".concat(t.getFullYear(),"-").concat((t.getMonth()+1).toString().padStart(2,"0"),"-").concat(t.getDate())},S=function(t){return new Date(t).toISOString().split("T")[0]}}}]);
//# sourceMappingURL=503.b3f70186.chunk.js.map