"use strict";(self.webpackChunktemple=self.webpackChunktemple||[]).push([[366],{2366:function(t,e,n){n.r(e);var r=n(5671),i=n(3144),a=n(136),c=n(9388),s=n(2791),o=n(3504),u=n(2822),f=n(4221),l=n(3446),d=n(6157),v=n(184),h=function(t){(0,a.Z)(n,t);var e=(0,c.Z)(n);function n(t){var i;return(0,r.Z)(this,n),(i=e.call(this,t)).UpdateAuth=function(){i.state.isSuperAdmin?(0,u.av)(i.state.users,(function(){f.fn.success("\u6210\u529f","\u66f4\u65b0\u6b0a\u9650",3e3)}),(function(){f.fn.error("\u932f\u8aa4","\u66f4\u65b0\u6b0a\u9650",3e3)})):i.state.isAdmin&&(0,u.Z9)(i.state.users,(function(){f.fn.success("\u6210\u529f","\u66f4\u65b0\u6b0a\u9650",3e3)}),(function(){f.fn.error("\u932f\u8aa4","\u66f4\u65b0\u6b0a\u9650",3e3)}))},i.state={users:null,isAdmin:"true"===localStorage.getItem("isAdmin"),isSuperAdmin:"true"===localStorage.getItem("isSuperAdmin")},i}return(0,i.Z)(n,[{key:"componentDidMount",value:function(){var t=this;this.state.isSuperAdmin?(0,u.xJ)((function(e){t.setState({users:e})})):this.state.isAdmin&&(0,u.Wo)((function(e){t.setState({users:e})}))}},{key:"CheckBoxValueChange",value:function(t,e){var n=e.target.getAttribute("data-key"),r=this.state.users;r[n][t]=!r[n][t],r[n].isChange=!0,this.setState({users:r})}},{key:"render",value:function(){var t=this;if(!this.state.users)return(0,v.jsx)(l.g,{});var e=[],n=[];return this.state.isSuperAdmin?(e=[(0,v.jsxs)("div",{className:"row mt-3 mb-3",children:[(0,v.jsx)("div",{className:"col-8 text-nowrap overflow-hidden text-truncate",children:"Email"},1),(0,v.jsx)("div",{className:"col-2 text-nowrap overflow-hidden text-truncate text-center",children:"\u555f\u52d5\u5e33\u865f"},2),(0,v.jsx)("div",{className:"col-2 text-nowrap overflow-hidden text-truncate text-center",children:"\u6388\u6b0a\u7ba1\u7406\u8005"},3)]},"header"),(0,v.jsx)("hr",{},"hr")],n=this.state.users.map((function(e,n){return(0,v.jsxs)("div",{className:"row mt-3 mb-3",children:[(0,v.jsx)("div",{className:"col-8 text-nowrap overflow-hidden text-truncate",children:e.email}),(0,v.jsx)("div",{className:"col-2 text-nowrap overflow-hidden text-truncate text-center",children:(0,v.jsx)("input",{type:"checkbox",checked:e.isActive,"data-key":n,onChange:function(e){return t.CheckBoxValueChange("isActive",e)}})}),(0,v.jsx)("div",{className:"col-2 text-nowrap overflow-hidden text-truncate text-center",children:(0,v.jsx)("input",{type:"checkbox",checked:e.isAdmin,"data-key":n,onChange:function(e){return t.CheckBoxValueChange("isAdmin",e)}})})]},e.Id)}))):this.state.isAdmin&&(e=[(0,v.jsxs)("div",{className:"row mt-3 mb-3",children:[(0,v.jsx)("div",{className:"col-9 text-nowrap overflow-hidden text-truncate",children:"Email"},1),(0,v.jsx)("div",{className:"col-3 text-nowrap overflow-hidden text-truncate text-center",children:"\u555f\u52d5\u5e33\u865f"},2)]},"header"),(0,v.jsx)("hr",{},"hr")],n=this.state.users.map((function(e,n){return(0,v.jsxs)("div",{className:"row mt-3 mb-3",children:[(0,v.jsx)("div",{className:"col-9 text-nowrap overflow-hidden text-truncate",children:e.email}),(0,v.jsx)("div",{className:"col-3 text-nowrap overflow-hidden text-truncate text-center",children:(0,v.jsx)("input",{type:"checkbox",checked:e.isActive,"data-key":n,onChange:function(e){return t.CheckBoxValueChange("isActive",e)}})})]},e.Id)}))),(0,v.jsx)("div",{className:"container",children:(0,v.jsxs)("div",{className:"mx-auto shadow rounded mt-5 mb-5",style:{maxWidth:"600px",width:"100%",padding:"40px 30px"},children:[(0,v.jsx)("p",{className:"fs-2 text-center",children:"\u6b0a\u9650\u7ba1\u7406"}),(0,v.jsxs)("div",{className:"row",children:[e,0===n.length?"\u6c92\u6709\u8cc7\u6599":n,(0,v.jsxs)("div",{className:"col-12 p-3 text-center position-sticky bottom-0",style:{backgroundColor:"white"},children:[(0,v.jsx)(d.Z,{disabled:0===n.length,className:"me-3",onClick:this.UpdateAuth,children:"\u66f4\u65b0"}),(0,v.jsx)(o.rU,{className:"btn btn-danger",to:"../join",children:"\u53d6\u6d88"})]},"footer")]})]})})}}]),n}(s.Component);e.default=h},6115:function(t,e,n){n.d(e,{C:function(){return s},n:function(){return c}});var r=n(9033),i=n(408),a=(0,r.v0)(),c=function(){return new Promise((function(t){if(a.currentUser)t(!0);else var e=(0,r.v0)().onAuthStateChanged((function(n){e(),t(!!n)}))}))},s=function(t){return new Promise((function(e,n){(0,i.jM)(t,(function(t){e(t)}),(function(t){n(t)}),{onlyOnce:!0})}))}},2822:function(t,e,n){n.d(e,{CK:function(){return w},Ce:function(){return x},EJ:function(){return m},N5:function(){return C},NI:function(){return p},Ne:function(){return Z},Os:function(){return b},Wo:function(){return l},Z9:function(){return v},_k:function(){return y},_x:function(){return k},av:function(){return h},gk:function(){return j},tf:function(){return A},u$:function(){return g},xJ:function(){return d}});var r=n(1413),i=n(4165),a=n(5861),c=n(408),s=n(6115),o=n(9033),u=(0,c.N8)(),f=(0,o.v0)(),l=function(){var t=(0,a.Z)((0,i.Z)().mark((function t(e){var n,r,a;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={},r={},a={},t.next=5,(0,s.C)((0,c.iH)(u,"isActive")).then((function(t){t.exists()&&"object"===typeof t.val()&&(n=t.val())}));case 5:return t.next=7,(0,s.C)((0,c.iH)(u,"isAdmin")).then((function(t){t.exists()&&"object"===typeof t.val()&&(r=t.val())}));case 7:return t.next=9,(0,s.C)((0,c.iH)(u,"isSuperAdmin")).then((function(t){t.exists()&&"object"===typeof t.val()&&(a=t.val())}));case 9:return t.next=11,(0,s.C)((0,c.iH)(u,"users")).then((function(t){if(t.exists()){for(var i=t.val(),c=Object.keys(i),s=[],o=0;o<c.length;o++){var u=i[c[o]];if(!a[c[o]]&&!r[c[o]]){var f={Id:c[o],email:u.email||!1,isActive:n[c[o]]||!1,isAdmin:r[c[o]]||!1,isChange:!1};s.push(f)}}e(s)}else e([])})).catch((function(t){console.error(t)}));case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),d=function(){var t=(0,a.Z)((0,i.Z)().mark((function t(e){var n,r,a;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={},r={},a={},t.next=5,(0,s.C)((0,c.iH)(u,"isActive")).then((function(t){t.exists()&&"object"===typeof t.val()&&(n=t.val())}));case 5:return t.next=7,(0,s.C)((0,c.iH)(u,"isAdmin")).then((function(t){t.exists()&&"object"===typeof t.val()&&(r=t.val())}));case 7:return t.next=9,(0,s.C)((0,c.iH)(u,"isSuperAdmin")).then((function(t){t.exists()&&"object"===typeof t.val()&&(a=t.val())}));case 9:return t.next=11,(0,s.C)((0,c.iH)(u,"users")).then((function(t){if(t.exists()){for(var i=t.val(),c=Object.keys(i),s=[],o=0;o<c.length;o++){var u=i[c[o]];if(!a[c[o]]){var f={Id:c[o],email:u.email||!1,isActive:n[c[o]]||!1,isAdmin:r[c[o]]||!1,isChange:!1};s.push(f)}}e(s)}else e([])})).catch((function(t){console.error(t)}));case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),v=function(t,e,n){try{for(var r=0;r<t.length;r++){var i=t[r];i.isChange&&(0,c.t8)((0,c.iH)(u,"isActive/".concat(i.Id)),i.isActive)}e()}catch(a){n(a)}},h=function(t,e,n){try{for(var r=0;r<t.length;r++){var i=t[r];i.isChange&&((0,c.t8)((0,c.iH)(u,"isActive/".concat(i.Id)),i.isActive),(0,c.t8)((0,c.iH)(u,"isAdmin/".concat(i.Id)),i.isAdmin))}e()}catch(a){n(a)}},x=function(t,e,n,i){(0,c.t8)((0,c.iH)(u,"activity/".concat(t)),(0,r.Z)((0,r.Z)({},e),{},{time:(new Date).getTime()})).then((function(t){return n()})).catch((function(t){return i()}))},p=function(t,e,n,i){(0,c.t8)((0,c.iH)(u,"activity/".concat(t)),(0,r.Z)((0,r.Z)({},e),{},{time:(new Date).getTime()})).then((function(t){return n()})).catch(i)},m=function(t){(0,c.U2)((0,c.iH)(u,"activity/")).then((function(e){e.exists()?t(Object.keys(e.val()).length):t(0)})).catch((function(t){console.error(t)}))},w=function(){var t=(0,a.Z)((0,i.Z)().mark((function t(e){return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,s.n)();case 2:(0,s.C)((0,c.iH)(u,"activity")).then((function(t){if(t.exists()){var n=t.val().map((function(t,e){return(0,r.Z)((0,r.Z)({},t),{},{date:N(t.date),id:e})})).filter((function(t){return new Date(A())<=new Date(t.date)})).sort((function(t,e){return t.date<e.date?1:-1}));e(n)}else e([])})).catch((function(t){console.error(t)}));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),g=function(){var t=(0,a.Z)((0,i.Z)().mark((function t(e){return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,s.n)();case 2:(0,s.C)((0,c.iH)(u,"activity")).then((function(t){if(t.exists()){var n=t.val().map((function(t,e){return(0,r.Z)((0,r.Z)({},t),{},{date:N(t.date),id:e})}));e(n.sort((function(t,e){return t.date<e.date?1:-1})))}else e([])})).catch((function(t){console.error(t)}));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),b=function(t,e){(0,s.C)((0,c.iH)(u,"activity/".concat(t))).then((function(t){if(t.exists()){var n=t.val();e({name:n.name,date:new Date(n.date).toISOString().split("T")[0]})}else e([])})).catch((function(t){console.error(t)}))},y=function(){var t=(0,a.Z)((0,i.Z)().mark((function t(e,n,r){var a;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,s.n)();case 2:a=f.currentUser,(0,s.C)((0,c.iH)(u,"join/".concat(e,"/").concat(a.uid))).then((function(t){t.exists()?n(t.val()):n([{name:"",birthday:"",light1:!1,light2:!1}])})).catch((function(t){r(t)}));case 4:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),j=function(t,e,n,r){var i=f.currentUser;(0,c.t8)((0,c.iH)(u,"join/".concat(t,"/").concat(i.uid)),e).then((function(t){return n()})).catch((function(t){return r()}))},Z=function(){var t=(0,a.Z)((0,i.Z)().mark((function t(e,n,r){return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,s.n)();case 2:(0,s.C)((0,c.iH)(u,"join/".concat(e))).then((function(t){if(t.exists()){for(var e=t.val(),r=Object.keys(e),i=[],a=0;a<r.length;a++)i=i.concat(e[r[a]]);n(i)}else n([])})).catch((function(t){r(t)}));case 3:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),C=function(){var t=(0,a.Z)((0,i.Z)().mark((function t(e,n,r){var a;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,s.n)();case 2:a=f.currentUser,(0,c.t8)((0,c.iH)(u,"template/".concat(a.uid)),e).then((function(t){return n()})).catch((function(t){return r()}));case 4:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),k=function(){var t=(0,a.Z)((0,i.Z)().mark((function t(e,n){var r;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,s.n)();case 2:r=f.currentUser,(0,s.C)((0,c.iH)(u,"template/".concat(r.uid))).then((function(t){if(!t.exists())throw new Error("nodata");e(t.val())})).catch((function(t){n(t)}));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),A=function(){var t=new Date;return"".concat(t.getFullYear(),"-").concat((t.getMonth()+1).toString().padStart(2,"0"),"-").concat(t.getDate())},N=function(t){return new Date(t).toISOString().split("T")[0]}},6157:function(t,e,n){n.d(e,{Z:function(){return p}});var r=n(1413),i=n(885),a=n(5987),c=n(1694),s=n.n(c),o=n(2791),u=n(184),f=["as","disabled"];function l(t){var e=t.tagName,n=t.disabled,r=t.href,i=t.target,a=t.rel,c=t.onClick,s=t.tabIndex,o=void 0===s?0:s,u=t.type;e||(e=null!=r||null!=i||null!=a?"a":"button");var f={tagName:e};if("button"===e)return[{type:u||"button",disabled:n},f];var l=function(t){(n||"a"===e&&function(t){return!t||"#"===t.trim()}(r))&&t.preventDefault(),n?t.stopPropagation():null==c||c(t)};return"a"===e&&(r||(r="#"),n&&(r=void 0)),[{role:"button",disabled:void 0,tabIndex:n?void 0:o,href:r,target:"a"===e?i:void 0,"aria-disabled":n||void 0,rel:"a"===e?a:void 0,onClick:l,onKeyDown:function(t){" "===t.key&&(t.preventDefault(),l(t))}},f]}var d=o.forwardRef((function(t,e){var n=t.as,r=t.disabled,a=function(t,e){if(null==t)return{};var n,r,i={},a=Object.keys(t);for(r=0;r<a.length;r++)n=a[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,f),c=l(Object.assign({tagName:n,disabled:r},a)),s=(0,i.Z)(c,2),o=s[0],d=s[1].tagName;return(0,u.jsx)(d,Object.assign({},a,o,{ref:e}))}));d.displayName="Button";var v=n(162),h=["as","bsPrefix","variant","size","active","className"],x=o.forwardRef((function(t,e){var n=t.as,c=t.bsPrefix,o=t.variant,f=t.size,d=t.active,x=t.className,p=(0,a.Z)(t,h),m=(0,v.vE)(c,"btn"),w=l((0,r.Z)({tagName:n},p)),g=(0,i.Z)(w,2),b=g[0],y=g[1].tagName;return(0,u.jsx)(y,(0,r.Z)((0,r.Z)((0,r.Z)({},b),p),{},{ref:e,className:s()(x,m,d&&"active",o&&"".concat(m,"-").concat(o),f&&"".concat(m,"-").concat(f),p.href&&p.disabled&&"disabled")}))}));x.displayName="Button",x.defaultProps={variant:"primary",active:!1,disabled:!1};var p=x},162:function(t,e,n){n.d(e,{pi:function(){return s},vE:function(){return c}});var r=n(2791),i=(n(184),["xxl","xl","lg","md","sm","xs"]),a=r.createContext({prefixes:{},breakpoints:i});a.Consumer,a.Provider;function c(t,e){var n=(0,r.useContext)(a).prefixes;return t||n[e]||e}function s(){return(0,r.useContext)(a).breakpoints}},5987:function(t,e,n){n.d(e,{Z:function(){return i}});var r=n(3366);function i(t,e){if(null==t)return{};var n,i,a=(0,r.Z)(t,e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(t);for(i=0;i<c.length;i++)n=c[i],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}}}]);
//# sourceMappingURL=366.9996c285.chunk.js.map